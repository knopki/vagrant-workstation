# Vagrant box с полезными для работы утилитами

Собирается при помощи ansible даже под Windows, спасибо [JJG-Ansible-Windows](https://github.com/geerlingguy/JJG-Ansible-Windows).
 
## Зачем это нужно и какие проблемы решает

Требуется кроссплатформенное решение для организации рабочего места (cli only) системного администратора (или оператора, но и программисту тоже пригодится) со стандартным окружением, рабочими утилитами и т.п. Проблема в том, что часть утилит работает только под linux, часть работает только под linux и mac os x, часть как бы работает везде, но при этом имеет те или иные проблемы совместимости. Даже нативные утилиты ведут себя различно в зависимости от версии и дистрибутива. Данное решение позволяет поднять стандартное и одинаковое окружение под любой современной ОС для (пока) консольной работы, компиляций, сетевых изысканий, управления удалёнными машиными с linux и не только на борту.
 
## Требуемое ПО

 * [Oracle VirtualBox x64](https://www.virtualbox.org/) (возможны другие варианты, но это надо будет реализовывать)
 * [Vagrant](https://www.vagrantup.com/)
 * [Git for Windows](http://git-for-windows.github.io/) (требуется на Windows, остальные обходятся утилитами git, ssh, ssh-agent из стандартных пакетов)
 * [ConEmu](http://conemu.github.io/ru/index.html) (опционально, только Windows, это удобно, воспользуйтесь приложенным файлом конфигурации)
 * [Posh-SSH](https://github.com/darkoperator/Posh-SSH) / [Putty pageant](http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html) (опционально, только Windows)

## Инструкция по установке

Скачиваем и устанавливаем Oracle Virtualbox (64-битный). Во время установки оставляем всё по-умолчанию. Если требуется перезагрузка - перезагружаемся.

Устанавливаем Vagrant. Никакая настройка не требуется.

Скачиваем последний релиз, распаковываем в какое-то удобное место, например, в ~/Development/workstation. Открываем консоль, переходим туда и вводим vagrant up. После этого скачивается базовый образ виртуальной машины, выполняются все скрипты по установке и настройке ПО. В идеале, ничего крайного на экране появляться не должно, если что-то не получилось, то это могут быть проблемы с сетью, попробуйте vagrant provision для повторения процедуры настройки.

Настройки по умолчанию такие, что пробрасывают вашу домашнюю директорию в виртуальную машину по пути /vagrant/home. Затем создаются симлинки, чтобы в домашней директории в виртуальной машине появились нужные проброшенные конфиги (или они будут созданы). На момент написания статьи создаются симлинки для директорий: ~/.config, ~/.docker, ~/.gitconfig, ~/Development (в этой директории вам предлагается держать ваши проекты).

Также в виртуальной машине будет установлен по умолчанию zsh и стандартный конфиг из комплекта oh-my-zsh.

Если у вас каким-то образом загружен в память ваш SSH-ключ, то он будет пробрасываться в виртуальную машину. Соответственно, вы сможете подключаться с неё к другим машинам без лишних телодвижений.

## Стандартный вариант использования

Запускаем ConEmu с PowerShell или другое любимое сочетание эмулятора терминала с командной оболочкой, переходим в директорию с конфигурационными файлами (см. выше, например, ~/Development/workstation), запускаем vagrant up (если виртуальная машина ещё не запущена) и vagrant ssh. Вторая команда моментально отправляет нас в командную оболочку виртуальной машины под пользователем vagrant, где мы можем работать с любыми нашими проектами.
